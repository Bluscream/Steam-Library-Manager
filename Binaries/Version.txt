1.3.0.0|Complete overhaul as wpf